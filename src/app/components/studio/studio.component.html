<div
  class="studio-container bg-neutral-900 text-neutral-200 h-full flex flex-col"
>
  <!-- Studio Header -->
  <header
    class="studio-header p-4 border-b-2 border-neutral-800 flex justify-between items-center"
  >
    <div>
      <h1 class="text-3xl font-bold text-purple-400">The Pantheon of Sound</h1>
      <p class="text-sm text-neutral-400">
        Armed for Recording:
        <span class="font-bold text-red-400">{{
          armedChannels().join(', ') || 'None'
        }}</span>
      </p>
    </div>
    <div class="flex items-center gap-4">
      <div class="text-center">
        <div class="text-2xl font-bold" [class.text-red-500]="isRecording()">
          {{ recordingStatus() }}
        </div>
        <div class="text-xs text-neutral-500">00:00:00</div>
      </div>
      <button
        (click)="toggleRecording()"
        class="w-20 h-20 rounded-full flex items-center justify-center"
        [class.bg-red-700]="isRecording()"
        [class.bg-neutral-700]="!isRecording()"
      >
        <i class="fas fa-microphone-alt text-4xl"></i>
      </button>
    </div>
  </header>

  <!-- Collaboration Section -->
  <div
    class="collaboration-section bg-neutral-800 p-3 border-b-2 border-neutral-700"
  >
    <div *ngIf="!session()" class="flex items-center justify-center gap-4">
      <button
        (click)="startCollaboration()"
        class="px-4 py-2 bg-blue-600 rounded-md font-bold"
      >
        Start Collaboration
      </button>
      <div class="flex items-center gap-2">
        <input
          type="text"
          [value]="sessionIdInput()"
          (input)="sessionIdInput.set($event.target.value)"
          placeholder="Enter Session ID"
          class="p-2 bg-neutral-700 border-neutral-600 rounded-md"
        />
        <button
          (click)="joinCollaboration()"
          class="px-4 py-2 bg-green-600 rounded-md font-bold"
        >
          Join
        </button>
      </div>
    </div>

    <div *ngIf="session() as s" class="flex items-center justify-between">
      <div>
        <span class="font-bold text-purple-400">Session ID:</span>
        <span class="ml-2 font-mono bg-neutral-700 px-2 py-1 rounded-md">{{
          s.sessionId
        }}</span>
      </div>
      <div class="flex items-center gap-3">
        <span class="font-bold">Participants:</span>
        <div class="flex gap-2">
          <div
            *ngFor="let participant of s.participants"
            class="w-8 h-8 rounded-full bg-neutral-700 flex items-center justify-center font-bold"
            [title]="participant.artistName"
          >
            {{ participant.artistName.charAt(0) }}
          </div>
        </div>
      </div>
      <button
        (click)="leaveCollaboration()"
        class="px-4 py-2 bg-red-600 rounded-md font-bold"
      >
        Leave Session
      </button>
    </div>
  </div>

  <!-- Main Mixer Area -->
  <main
    class="studio-main-content flex-grow p-4 flex flex-col gap-4 overflow-y-auto"
  >
    <div class="mixer-area flex gap-4 overflow-x-auto pb-4">
      <!-- Channel Strips -->
      <div
        *ngFor="let channel of micChannels()"
        class="channel-strip bg-neutral-800 p-4 rounded-lg flex flex-col items-center gap-4 w-48 flex-shrink-0"
      >
        <h2 class="font-bold text-lg">{{ channel.label }}</h2>
        <div
          class="fader-track h-64 w-8 bg-neutral-900 rounded-full flex justify-center py-2"
        >
          <input
            type="range"
            orient="vertical"
            min="0"
            max="100"
            [value]="channel.level"
            (input)="updateChannelLevel(channel.id, +$event.target.value)"
            class="w-2 h-full"
          />
        </div>
        <div class="text-sm font-mono">{{ channel.level }}</div>
      </div>

      <!-- Master Fader -->
      <div
        class="master-strip bg-neutral-800 p-4 rounded-lg flex flex-col items-center gap-4 w-48 flex-shrink-0 border-2 border-purple-500"
      >
        <h2 class="font-bold text-lg text-purple-400">MASTER</h2>
        <div
          class="fader-track h-64 w-8 bg-neutral-900 rounded-full flex justify-center py-2"
        >
          <input
            type="range"
            orient="vertical"
            min="0"
            max="100"
            [value]="masterVolume()"
            (input)="updateMasterVolume(+$event.target.value)"
            class="w-2 h-full"
          />
        </div>
        <div class="text-sm font-mono">{{ masterVolume() }}</div>
      </div>
    </div>

    <!-- Strategic Recommendations -->
    <app-recommendations></app-recommendations>
  </main>

  <!-- Studio Footer -->
  <footer
    class="studio-footer p-2 border-t-2 border-neutral-800 text-center text-xs text-neutral-600 mt-auto"
  >
    <p>S.M.U.V.E. 2.0 - The Sound of Inevitability</p>
  </footer>
</div>
